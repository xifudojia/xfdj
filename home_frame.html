<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>幸福按摩</title>
    <link rel="stylesheet" href="./mobileSize.css">
</head>

<style>
    #container_ExBottomNav {
        background-color: white;
        width: 100%;
        padding-bottom: 0px;
    }
</style>

<body class="body_noscroll">
    <div class="container_noscroll">

        <div style="height: 100%;width: 100%; overflow-y: auto;">
            <iframe id="main_iframe" style="width: 100%;height: 100%;;" src="./home.html" frameborder="0"></iframe>
        </div>


        <div id="container_ExBottomNav"></div>

    </div>
</body>

<script src="./ExBottomNav.js"></script>
<script src="./ExImageCarousel.js"></script>
<script src="./ExMobileHeader.js"></script>
<script src="./ExJiShiList.js"></script>
<script src="./ExPhoneModal.js"></script>
<script src="./thisdata.js"></script>
<script src="./my.js"></script>
<script type="module">



    const nav = new ExBottomNav(document.getElementById("container_ExBottomNav"), {
        activeIndex: 0,
        onItemClick: onswitch
    });

    function onswitch(id, index, element) {

        console.log(`点击了: ${id}, 索引: ${index}`);
        const ele = document.getElementById("main_iframe");
        const pageMap = {
            order: "./order_list_empty_state.html",
            home: "./home.html",
            teacher: "./select_jishi.html",
            profile: "./ExUserCenter.js.html"
        };
        if (pageMap[id]) {
            ele.src = pageMap[id];
        }



    }


    function addEventListener_message() {
        window.addEventListener("message", (event) => {
            // 可选：检查消息来源，确保安全
            // if (event.origin !== "http://example.com") return;
            console.log("父页面收到消息000:", event.data);

            if (event.data.type === "refresh") {
                onswitch(event.data.message, "", "");
                nav.setActive2('teacher');

            }



            if (event.data.type === "topay") {

                ss("f1d000051v56ds666");

                window.location.href= event.data.message;
                }




        });
    }

    function login() {
        let userphone = localStorage.getItem(ff_userphone);
        if (userphone) return;


        const modal = new ExPhoneModal({
            title: "绑定手机号",
            phoneValue: "",
            submitText: "立即绑定",
            autoClose: 2000,
            onSubmit: (phone) => {
                console.log("手机号:", phone);
                localStorage.setItem(ff_userphone, phone);
            },
            onClose: (manuallyClosed = "") => {
                location.reload(true);

            }
        });


        modal.show();
    }


    function save_userLocation() {


        let fromLocation="宝安区";
        let fromLocationId = getUrlQueryParams("fromLocationId");
        if (!fromLocationId)fromLocationId=0;


        localStorage.setItem(ff_userLocation_code, fromLocationId);

        if (fromLocation == 2656) {

        }
            localStorage.setItem(ff_userLocation,fromLocation);

    }



    function redict(url){
        window.location.href=url;
    }
    window.redict=redict;


    login();
    save_userLocation();
    addEventListener_message();





</script>

</html>